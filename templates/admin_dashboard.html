<!DOCTYPE html>
<html lang="es">
<head>
    <title>Dashboard Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Roboto', sans-serif; background-color: #f4f7f6; padding: 20px; }
        .container { max-width: 1200px; margin: auto; }
        
        /* HEADER */
        .top-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .logout { color: #e74c3c; text-decoration: none; font-weight: bold; }
        
        /* KPI CARDS */
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .kpi-card { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); border-left: 5px solid #2ecc71; }
        .kpi-card h3 { margin: 0; color: #7f8c8d; font-size: 0.9rem; text-transform: uppercase; }
        .kpi-card strong { font-size: 2rem; color: #2c3e50; display: block; margin-top: 10px; }

        /* SECCIONES DE GESTI√ìN */
        .mgmt-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 40px; }
        .mgmt-card { background: white; padding: 25px; border-radius: 10px; text-align: center; transition: transform 0.2s; cursor: pointer; border: 1px solid #eee; text-decoration: none; color: #333; }
        .mgmt-card:hover { transform: translateY(-5px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .mgmt-icon { font-size: 2.5rem; margin-bottom: 10px; display: block; }
        .mgmt-card h4 { margin: 0; font-size: 1.2rem; }
        .mgmt-card p { color: #7f8c8d; font-size: 0.9rem; }

        /* TABLA Y REPORTE */
        .section-header { display: flex; align-items: center; gap: 15px; margin-bottom: 15px; }
        .btn-report { background: #3498db; color: white; padding: 8px 15px; text-decoration: none; border-radius: 5px; font-weight: bold; font-size: 0.9rem; cursor: pointer; border: none; }
        
        table { width: 100%; background: white; border-collapse: collapse; border-radius: 8px; overflow: hidden; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #34495e; color: white; }

        /* MODAL REPORTES */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); justify-content: center; align-items: center; }
        .modal-content { background: white; padding: 30px; border-radius: 10px; width: 300px; }
        input[type="date"] { width: 100%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; box-sizing: border-box; }
        .btn-block { width: 100%; padding: 10px; background: #27ae60; color: white; border: none; font-weight: bold; cursor: pointer; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="top-bar">
            <h1>Panel General</h1>
            <div>
                <span>Hola, Admin</span> | <a href="/logout" class="logout">Salir</a>
            </div>
        </div>

        <div class="kpi-grid">
            <div class="kpi-card">
                <h3>Recaudaci√≥n Total</h3>
                <strong>${{ recaudacion }}</strong>
            </div>
            <div class="kpi-card" style="border-color: #3498db;">
                <h3>Ventas Hoy</h3>
                <strong>-</strong> </div>
        </div>

        <div class="mgmt-grid">
            <a href="/admin/sabores" class="mgmt-card">
                <span class="mgmt-icon">üç¶</span>
                <h4>Sabores</h4>
                <p>Reponer baldes, crear nuevos</p>
                <span style="color: #3498db; font-weight: bold;">GESTIONAR &rarr;</span>
            </a>
            <a href="/admin/insumos" class="mgmt-card">
                <span class="mgmt-icon">üì¶</span>
                <h4>Envases</h4>
                <p>Control de potes y vasos</p>
                <span style="color: #3498db; font-weight: bold;">GESTIONAR &rarr;</span>
            </a>
            <a href="/admin/precios" class="mgmt-card">
                <span class="mgmt-icon">üí≤</span>
                <h4>Precios</h4>
                <p>Editar lista de precios</p>
                <span style="color: #3498db; font-weight: bold;">GESTIONAR &rarr;</span>
            </a>
            <a href="/admin/usuarios" class="mgmt-card">
                <span class="mgmt-icon">üë•</span>
                <h4>Usuarios</h4>
                <p>Crear vendedores y claves</p>
                <span style="color: #3498db; font-weight: bold;">GESTIONAR &rarr;</span>
            </a>
            <a href="/admin/promos" class="mgmt-card">
                <span class="mgmt-icon">üéÅ</span>
                <h4>Promos</h4>
                <p>Configurar combos</p>
                <span style="color: #3498db; font-weight: bold;">GESTIONAR &rarr;</span>
            </a>
        </div>

        <div class="section-header">
            <h2 style="margin:0;">√öltimas Ventas</h2>
            <button onclick="abrirModal()" class="btn-report">üìÑ REPORTE EXCEL</button>
        </div>
        
        <table>
            <thead><tr><th>Fecha</th><th>Sucursal</th><th>Detalle</th><th>Total</th></tr></thead>
            <tbody>
            {% for v in ventas %}
            <tr>
                <td>{{ v.fecha.strftime('%d/%m %H:%M') }}</td>
                <td><strong>{{ v.sucursal }}</strong></td>
                <td>{{ v.detalle }}</td>
                <td style="color: green; font-weight: bold;">${{ v.total }}</td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div id="modalReporte" class="modal">
        <div class="modal-content">
            <h3 style="margin-top:0;">Descargar Reporte</h3>
            <form action="/admin/reporte" method="POST">
                <label>Desde:</label>
                <input type="date" name="fecha_inicio" required>
                <label>Hasta:</label>
                <input type="date" name="fecha_fin" required>
                <button type="submit" class="btn-block">DESCARGAR</button>
                <button type="button" onclick="cerrarModal()" style="background:none; border:none; color:#777; width:100%; margin-top:10px; cursor:pointer;">Cancelar</button>
            </form>
        </div>
    </div>

    <script>
        function abrirModal() { document.getElementById('modalReporte').style.display = 'flex'; }
        function cerrarModal() { document.getElementById('modalReporte').style.display = 'none'; }
    </script>
</body>
</html>