{% extends "base.html" %}

{% block content %}
<div class="container fade-in">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>游꼱 Gesti칩n de Sabores y Stock</h2>
        <form class="d-flex gap-2" method="POST">
            <input type="hidden" name="accion" value="crear">
            <input type="text" name="nombre" class="form-control" placeholder="Nombre nuevo sabor" required>
            <button class="btn btn-primary" type="submit">Crear</button>
        </form>
    </div>

    <div class="row">
        {% for s in sabores %}
        <div class="col-md-6 col-lg-4 mb-3">
            <div class="card shadow-sm h-100 {% if not s.activo %}bg-light text-muted{% endif %}">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <h5 class="card-title">{{ s.nombre }}</h5>
                        {% if not s.activo %}
                            <span class="badge bg-secondary">Inactivo</span>
                        {% endif %}
                    </div>

                    <div class="row mt-3 text-center">
                        <div class="col-6 border-end">
                            <small class="text-muted">M치ximo Paz</small>
                            <h4 class="{% if s.stock_maximo < 5000 %}text-danger{% else %}text-success{% endif %}">
                                {{ (s.stock_maximo / 1000) | round(1) }} <span style="font-size: 0.7em">kg</span>
                            </h4>
                        </div>
                        <div class="col-6">
                            <small class="text-muted">Trist치n Su치rez</small>
                            <h4 class="{% if s.stock_tristan < 5000 %}text-danger{% else %}text-success{% endif %}">
                                {{ (s.stock_tristan / 1000) | round(1) }} <span style="font-size: 0.7em">kg</span>
                            </h4>
                        </div>
                    </div>

                    <hr>

                    <form method="POST" class="mt-2">
                        <input type="hidden" name="accion" value="agregar_stock">
                        <input type="hidden" name="sabor_nombre" value="{{ s.nombre }}">
                        
                        <div class="input-group mb-2">
                            <input type="number" step="0.5" name="cant_baldes" class="form-control" placeholder="Baldes" required>
                            <select name="sucursal_destino" class="form-select" required>
                                <option value="" disabled selected>쮻칩nde?</option>
                                <option value="M치ximo Paz">M치ximo Paz</option>
                                <option value="Trist치n Su치rez">Trist치n Su치rez</option>
                            </select>
                            <button class="btn btn-success" type="submit">+</button>
                        </div>
                    </form>

                    <form method="POST" class="mt-2 text-end">
                        <input type="hidden" name="accion" value="cambiar_estado">
                        <input type="hidden" name="sabor_nombre" value="{{ s.nombre }}">
                        <button type="submit" class="btn btn-sm btn-link text-decoration-none text-muted">
                            {{ "Ocultar" if s.activo else "Reactivar" }}
                        </button>
                    </form>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}